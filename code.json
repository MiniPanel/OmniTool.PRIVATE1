{
  "guides": {},
  "ctcs": [
    {
      "id": "ctc_1765405934698_616",
      "label": "Trade",
      "content": "(function () {\n  // Generic wait helper\n  const waitFor = (getter, label, timeout = 10000, interval = 300) =>\n    new Promise((resolve, reject) => {\n      const start = Date.now();\n      const timer = setInterval(() => {\n        if (Date.now() - start > timeout) {\n          clearInterval(timer);\n          console.warn('timeout waiting for', label);\n          reject(new Error('timeout ' + label));\n          return;\n        }\n        const el = getter();\n        if (!el) return;\n        clearInterval(timer);\n        resolve(el);\n      }, interval);\n    });\n\n  const isVisible = el => {\n    if (!el) return false;\n    const r = el.getBoundingClientRect();\n    const s = getComputedStyle(el);\n    return r.width > 0 && r.height > 0 &&\n           s.display !== 'none' && s.visibility !== 'hidden';\n  };\n\n  // Open sitemap\n  const siteBtn = [...document.querySelectorAll('button')]\n    .find(b => (b.getAttribute('aria-label') || '')\n      .toLowerCase()\n      .includes('site'));\n  siteBtn?.click();\n\n  (async () => {\n    const all = () => [...document.querySelectorAll('*')];\n\n    // 1) Service -> Cases\n    const service = await waitFor(() =>\n      all().find(el => {\n        if (!isVisible(el)) return false;\n        const t = (el.innerText || el.textContent || '').trim().toLowerCase();\n        return t === 'service';\n      }),\n      'service'\n    );\n\n    const section =\n      service.closest('section, nav, div, ul, li') || service.parentElement;\n\n    const casesRow = await waitFor(() =>\n      [...section.querySelectorAll('*')].find(el => {\n        if (!isVisible(el)) return false;\n        const t = (el.innerText || el.textContent || '').trim().toLowerCase();\n        return t === 'cases';\n      }),\n      'cases row'\n    );\n\n    const casesBtn =\n      casesRow.querySelector('button, a, [role=\"menuitem\"]') || casesRow;\n    casesBtn.click();\n\n    // 2) Click \"Edit filters\"\n    const editBtn = await waitFor(() => {\n      const byId = document.querySelector('#open-advanced-filter');\n      if (byId && isVisible(byId)) return byId;\n      return [...document.querySelectorAll('button')].find(b => {\n        if (!isVisible(b)) return false;\n        const t = (b.innerText || b.textContent || '').trim().toLowerCase();\n        return t === 'edit filters';\n      });\n    }, 'Edit filters');\n    editBtn.click();\n\n    // 3) Click \"+ Add\"\n    const addBtn = await waitFor(() => {\n      const byId = document.querySelector('#AddMenu0');\n      if (byId && isVisible(byId)) return byId;\n      return [...document.querySelectorAll('button')].find(b => {\n        if (!isVisible(b)) return false;\n        const t = (b.innerText || b.textContent || '').trim().toLowerCase();\n        return t === 'add' || t === '+ add' || t.endsWith(' add');\n      });\n    }, 'Add button');\n    addBtn.click();\n\n    // 4) Click \"Add row\"\n    const addRowBtn = await waitFor(() => {\n      const candidates = document.querySelectorAll(\n        'button, [role=\"menuitem\"], .ms-ContextualMenu-link'\n      );\n      return [...candidates].find(el => {\n        if (!isVisible(el)) return false;\n        const t = (el.innerText || el.textContent || '').trim().toLowerCase();\n        return t === 'add row' || t.includes('add row');\n      });\n    }, 'Add row');\n    addRowBtn.click();\n\n    // helper to get grouped carets for last row\n    const getLastRowButtons = () => {\n      const carets = [...document.querySelectorAll(\n        'button.ms-ComboBox-CaretDown-button, button[aria-haspopup=\"listbox\"]'\n      )]\n        .filter(b => {\n          const r = b.getBoundingClientRect();\n          const s = getComputedStyle(b);\n          return r.width > 0 && r.height > 0 &&\n                 s.display !== 'none' && s.visibility !== 'hidden';\n        })\n        .sort((a, b) => {\n          const ra = a.getBoundingClientRect();\n          const rb = b.getBoundingClientRect();\n          if (Math.abs(ra.top - rb.top) > 2) return ra.top - rb.top;\n          return ra.left - rb.left;\n        });\n\n      if (!carets.length) return null;\n\n      const rows = [];\n      const rowTolerance = 4;\n      carets.forEach(btn => {\n        const r = btn.getBoundingClientRect();\n        const y = r.top;\n        let row = rows.find(row => Math.abs(row.y - y) <= rowTolerance);\n        if (!row) {\n          row = { y, buttons: [] };\n          rows.push(row);\n        }\n        row.buttons.push(btn);\n      });\n\n      if (!rows.length) return null;\n      return rows[rows.length - 1].buttons; // buttons in last row, left->right\n    };\n\n    // 5) Click LAST row's FIRST dropdown (Field)\n    const newFieldDropdownBtn = await waitFor(() => {\n      const btns = getLastRowButtons();\n      return btns && btns[0];\n    }, 'last row FIELD dropdown');\n    newFieldDropdownBtn.click();\n\n    // 6) Choose \"Case Subject\"\n    const caseSubjectOption = await waitFor(() => {\n      const candidates = document.querySelectorAll(\n        'button, a, [role=\"menuitem\"], [role=\"option\"], .ms-ContextualMenu-link'\n      );\n      return [...candidates].find(el => {\n        if (!isVisible(el)) return false;\n        const text = (el.innerText || el.textContent || '')\n          .trim()\n          .toLowerCase();\n        return text === 'case subject' || text.endsWith('case subject');\n      });\n    }, 'Case Subject option');\n    caseSubjectOption.click();\n\n    // 7) Click LAST row's SECOND dropdown (Operator)\n    const operatorDropdownBtn = await waitFor(() => {\n      const btns = getLastRowButtons();\n      return btns && btns[1];\n    }, 'last row OPERATOR dropdown');\n    operatorDropdownBtn.click();\n\n    // 8) Select \"Contains\" in Operator dropdown\n    const containsOption = await waitFor(() => {\n      const options = document.querySelectorAll(\n        'button, a, [role=\"menuitem\"], [role=\"option\"], .ms-ContextualMenu-link'\n      );\n      return [...options].find(el => {\n        if (!isVisible(el)) return false;\n        const text = (el.innerText || el.textContent || '')\n          .trim()\n          .toLowerCase();\n        return text === 'contains';\n      });\n    }, '\"Contains\" operator');\n    containsOption.click();\n\n    // 9) Move focus from Operator to the VALUE input (like one Tab)\n    const focusNextInput = () => {\n      const focusables = [...document.querySelectorAll(\n        'input, textarea, button, [tabindex]'\n      )].filter(el => {\n        const r = el.getBoundingClientRect();\n        const s = getComputedStyle(el);\n        return r.width > 0 && r.height > 0 &&\n               s.display !== 'none' && s.visibility !== 'hidden' &&\n               !el.disabled && el.tabIndex >= 0;\n      });\n\n      const idx = focusables.indexOf(document.activeElement);\n      if (idx === -1) return;\n      const next = focusables[idx + 1];\n      if (next) next.focus();\n    };\n\n    focusNextInput(); // Operator -> Value\n\n    // 10) Type TRADE into whatever input gained focus\n    (function () {\n      const el = document.activeElement;\n      if (!el || el.tagName.toLowerCase() !== 'input') return;\n      el.focus();\n      el.select && el.select();\n      el.value = 'TRADE';\n      el.dispatchEvent(new Event('input',  { bubbles: true }));\n      el.dispatchEvent(new Event('change', { bubbles: true }));\n    })();\n\n    // 11) Move focus forward three times (Tab x3), then activate Apply\n    const focusNext = () => {\n      const focusables = [...document.querySelectorAll(\n        'input, textarea, button, [tabindex]'\n      )].filter(el => {\n        const r = el.getBoundingClientRect();\n        const s = getComputedStyle(el);\n        return r.width > 0 && r.height > 0 &&\n               s.display !== 'none' && s.visibility !== 'hidden' &&\n               !el.disabled && el.tabIndex >= 0;\n      });\n\n      const idx = focusables.indexOf(document.activeElement);\n      if (idx === -1) return;\n      const next = focusables[idx + 1];\n      if (next) next.focus();\n    };\n\n    // From VALUE box: Tab x3 until Apply\n    focusNext(); // first Tab\n    focusNext(); // second Tab\n    focusNext(); // third Tab\n\n    // \"Enter\" on the focused element (Apply)\n    (function () {\n      const el = document.activeElement;\n      if (!el) return;\n      if (el.tagName.toLowerCase() === 'button') {\n        el.click();\n      } else {\n        el.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter', bubbles: true }));\n        el.dispatchEvent(new KeyboardEvent('keyup',   { key: 'Enter', bubbles: true }));\n      }\n    })();\n  })().catch(console.error);\n})();\n"
    },
    {
      "id": "ctc_1765405960623_395",
      "label": "Cases",
      "content": "(function () {\n  // Generic wait helper\n  const waitFor = (getter, label, timeout = 10000, interval = 300) =>\n    new Promise((resolve, reject) => {\n      const start = Date.now();\n      const timer = setInterval(() => {\n        if (Date.now() - start > timeout) {\n          clearInterval(timer);\n          console.warn('timeout waiting for', label);\n          reject(new Error('timeout ' + label));\n          return;\n        }\n        const el = getter();\n        if (!el) return;\n        clearInterval(timer);\n        resolve(el);\n      }, interval);\n    });\n\n  const isVisible = el => {\n    if (!el) return false;\n    const r = el.getBoundingClientRect();\n    const s = getComputedStyle(el);\n    return r.width > 0 && r.height > 0 &&\n           s.display !== 'none' && s.visibility !== 'hidden';\n  };\n\n  // Open sitemap\n  const siteBtn = [...document.querySelectorAll('button')]\n    .find(b => (b.getAttribute('aria-label') || '')\n      .toLowerCase()\n      .includes('site'));\n  siteBtn?.click();\n\n  (async () => {\n    const all = () => [...document.querySelectorAll('*')];\n\n    // 1) Service -> Cases\n    const service = await waitFor(() =>\n      all().find(el => {\n        if (!isVisible(el)) return false;\n        const t = (el.innerText || el.textContent || '').trim().toLowerCase();\n        return t === 'service';\n      }),\n      'service'\n    );\n\n    const section =\n      service.closest('section, nav, div, ul, li') || service.parentElement;\n\n    const casesRow = await waitFor(() =>\n      [...section.querySelectorAll('*')].find(el => {\n        if (!isVisible(el)) return false;\n        const t = (el.innerText || el.textContent || '').trim().toLowerCase();\n        return t === 'cases';\n      }),\n      'cases row'\n    );\n\n    const casesBtn =\n      casesRow.querySelector('button, a, [role=\"menuitem\"]') || casesRow;\n    casesBtn.click();\n\n    // 2) Click \"Edit filters\"\n    const editBtn = await waitFor(() => {\n      const byId = document.querySelector('#open-advanced-filter');\n      if (byId && isVisible(byId)) return byId;\n      return [...document.querySelectorAll('button')].find(b => {\n        if (!isVisible(b)) return false;\n        const t = (b.innerText || b.textContent || '').trim().toLowerCase();\n        return t === 'edit filters';\n      });\n    }, 'Edit filters');\n    editBtn.click();\n\n    // 3) Click \"+ Add\"\n    const addBtn = await waitFor(() => {\n      const byId = document.querySelector('#AddMenu0');\n      if (byId && isVisible(byId)) return byId;\n      return [...document.querySelectorAll('button')].find(b => {\n        if (!isVisible(b)) return false;\n        const t = (b.innerText || b.textContent || '').trim().toLowerCase();\n        return t === 'add' || t === '+ add' || t.endsWith(' add');\n      });\n    }, 'Add button');\n    addBtn.click();\n\n    // 4) Click \"Add row\"\n    const clickAddRow = async () => {\n      const addRowBtn = await waitFor(() => {\n        const candidates = document.querySelectorAll(\n          'button, [role=\"menuitem\"], .ms-ContextualMenu-link'\n        );\n        return [...candidates].find(el => {\n          if (!isVisible(el)) return false;\n          const t = (el.innerText || el.textContent || '').trim().toLowerCase();\n          return t === 'add row' || t.includes('add row');\n        });\n      }, 'Add row');\n      addRowBtn.click();\n    };\n    await clickAddRow();\n\n    // helper to get grouped carets for all rows\n    const getRowButtons = () => {\n      const carets = [...document.querySelectorAll(\n        'button.ms-ComboBox-CaretDown-button, button[aria-haspopup=\"listbox\"]'\n      )]\n        .filter(b => {\n          const r = b.getBoundingClientRect();\n          const s = getComputedStyle(b);\n          return r.width > 0 && r.height > 0 &&\n                 s.display !== 'none' && s.visibility !== 'hidden';\n        })\n        .sort((a, b) => {\n          const ra = a.getBoundingClientRect();\n          const rb = b.getBoundingClientRect();\n          if (Math.abs(ra.top - rb.top) > 2) return ra.top - rb.top;\n          return ra.left - rb.left;\n        });\n\n      if (!carets.length) return [];\n\n      const rows = [];\n      const rowTolerance = 4;\n      carets.forEach(btn => {\n        const r = btn.getBoundingClientRect();\n        const y = r.top;\n        let row = rows.find(row => Math.abs(row.y - y) <= rowTolerance);\n        if (!row) {\n          row = { y, buttons: [] };\n          rows.push(row);\n        }\n        row.buttons.push(btn);\n      });\n\n      return rows; // [{y,buttons:[...]}...]\n    };\n\n    // 5) Click LAST row's FIRST dropdown (Field)\n    const newFieldDropdownBtn = await waitFor(() => {\n      const rows = getRowButtons();\n      if (!rows.length) return null;\n      const lastRowButtons = rows[rows.length - 1].buttons;\n      return lastRowButtons && lastRowButtons[0];\n    }, 'last row FIELD dropdown');\n    newFieldDropdownBtn.click();\n\n    // 6) Choose \"Case Subject\"\n    const caseSubjectOption = await waitFor(() => {\n      const candidates = document.querySelectorAll(\n        'button, a, [role=\"menuitem\"], [role=\"option\"], .ms-ContextualMenu-link'\n      );\n      return [...candidates].find(el => {\n        if (!isVisible(el)) return false;\n        const text = (el.innerText || el.textContent || '')\n          .trim()\n          .toLowerCase();\n        return text === 'case subject' || text.endsWith('case subject');\n      });\n    }, 'Case Subject option');\n    caseSubjectOption.click();\n\n    // 7) Click LAST row's SECOND dropdown (Operator)\n    const operatorDropdownBtn = await waitFor(() => {\n      const rows = getRowButtons();\n      if (!rows.length) return null;\n      const lastRowButtons = rows[rows.length - 1].buttons;\n      return lastRowButtons && lastRowButtons[1];\n    }, 'last row OPERATOR dropdown');\n    operatorDropdownBtn.click();\n\n    // 8) Select \"Does not contain\" in Operator dropdown\n    const doesNotContainOption = await waitFor(() => {\n      const options = document.querySelectorAll(\n        'button, a, [role=\"menuitem\"], [role=\"option\"], .ms-ContextualMenu-link'\n      );\n      return [...options].find(el => {\n        if (!isVisible(el)) return false;\n        const text = (el.innerText || el.textContent || '')\n          .trim()\n          .toLowerCase();\n        return text === 'does not contain' || text.endsWith('does not contain');\n      });\n    }, '\"Does not contain\" operator');\n    doesNotContainOption.click();\n\n    // 9) Move focus from Operator to the VALUE input (like one Tab)\n    const focusNextInput = () => {\n      const focusables = [...document.querySelectorAll(\n        'input, textarea, button, [tabindex]'\n      )].filter(el => {\n        const r = el.getBoundingClientRect();\n        const s = getComputedStyle(el);\n        return r.width > 0 && r.height > 0 &&\n               s.display !== 'none' && s.visibility !== 'hidden' &&\n               !el.disabled && el.tabIndex >= 0;\n      });\n\n      const idx = focusables.indexOf(document.activeElement);\n      if (idx === -1) return;\n      const next = focusables[idx + 1];\n      if (next) next.focus();\n    };\n\n    focusNextInput(); // Operator -> Value\n\n    // 10) Type TRADE into whatever input gained focus\n    (function () {\n      const el = document.activeElement;\n      if (!el || el.tagName.toLowerCase() !== 'input') return;\n      el.focus();\n      el.select && el.select();\n      el.value = 'TRADE';\n      el.dispatchEvent(new Event('input',  { bubbles: true }));\n      el.dispatchEvent(new Event('change', { bubbles: true }));\n    })();\n\n    // 11) Move focus forward three times (Tab x3), then activate Apply\n    const focusNext = () => {\n      const focusables = [...document.querySelectorAll(\n        'input, textarea, button, [tabindex]'\n      )].filter(el => {\n        const r = el.getBoundingClientRect();\n        const s = getComputedStyle(el);\n        return r.width > 0 && r.height > 0 &&\n               s.display !== 'none' && s.visibility !== 'hidden' &&\n               !el.disabled && el.tabIndex >= 0;\n      });\n\n      const idx = focusables.indexOf(document.activeElement);\n      if (idx === -1) return;\n      const next = focusables[idx + 1];\n      if (next) next.focus();\n    };\n\n    focusNext(); // first Tab\n    focusNext(); // second Tab\n    focusNext(); // third Tab\n\n    (function () {\n      const el = document.activeElement;\n      if (!el) return;\n      if (el.tagName.toLowerCase() === 'button') {\n        el.click();\n      } else {\n        el.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter', bubbles: true }));\n        el.dispatchEvent(new KeyboardEvent('keyup',   { key: 'Enter', bubbles: true }));\n      }\n    })();\n\n    // === EXTRA PART: Add another row with \"Case Subject\" / \"Does not contain\" / \"AU /\" ===\n\n    // 12) Click \"+ Add\" again then \"Add row\"\n    addBtn.click();\n    await clickAddRow();\n\n    // 13a) Click new last row's FIELD dropdown\n    const lastFieldDropdown = await waitFor(() => {\n      const rows = getRowButtons();\n      if (!rows.length) return null;\n      const lastRowButtons = rows[rows.length - 1].buttons;\n      return lastRowButtons && lastRowButtons[0];\n    }, 'new last row FIELD dropdown');\n    lastFieldDropdown.click();\n\n    // 13b) Choose \"Case Subject\" for second row\n    const caseSubjectOption2 = await waitFor(() => {\n      const candidates = document.querySelectorAll(\n        'button, a, [role=\"menuitem\"], [role=\"option\"], .ms-ContextualMenu-link'\n      );\n      return [...candidates].find(el => {\n        if (!isVisible(el)) return false;\n        const text = (el.innerText || el.textContent || '')\n          .trim()\n          .toLowerCase();\n        return text === 'case subject' || text.endsWith('case subject');\n      });\n    }, 'Case Subject option (second row)');\n    caseSubjectOption2.click();\n\n    // 13c) Click new last row's OPERATOR dropdown\n    const lastOpDropdown = await waitFor(() => {\n      const rows = getRowButtons();\n      if (!rows.length) return null;\n      const lastRowButtons = rows[rows.length - 1].buttons;\n      return lastRowButtons && lastRowButtons[1];\n    }, 'new last row OPERATOR dropdown');\n    lastOpDropdown.click();\n\n    // 13d) Select \"Does not contain\" for second row\n    const doesNotContainOption2 = await waitFor(() => {\n      const options = document.querySelectorAll(\n        'button, a, [role=\"menuitem\"], [role=\"option\"], .ms-ContextualMenu-link'\n      );\n      return [...options].find(el => {\n        if (!isVisible(el)) return false;\n        const text = (el.innerText || el.textContent || '')\n          .trim()\n          .toLowerCase();\n        return text === 'does not contain' || text.endsWith('does not contain');\n      });\n    }, '\"Does not contain\" operator (second row)');\n    doesNotContainOption2.click();\n\n    // 13e) Move focus from Operator to VALUE (one Tab) for this new row\n    focusNextInput(); // Operator -> Value of second row\n\n    // 13f) Type \"AU /\" into that VALUE textbox\n    (function () {\n      const el = document.activeElement;\n      if (!el || el.tagName.toLowerCase() !== 'input') return;\n      el.focus();\n      el.select && el.select();\n      el.value = 'AU /';\n      el.dispatchEvent(new Event('input',  { bubbles: true }));\n      el.dispatchEvent(new Event('change', { bubbles: true }));\n    })();\n  })().catch(console.error);\n})();\n"
    },
    {
      "id": "ctc_1765405974390_358",
      "label": "Breaks",
      "content": "// Ask for break minutes and time\nconst breakMinutes = prompt(\"‚è±Ô∏è Enter break duration in minutes (15 or 30):\");\nconst timeInput = prompt(\"‚è∞ Enter the time to run the code (HH:MM, 24-hour format):\");\n\nif (!breakMinutes || !timeInput) {\n  console.log(\"‚ùå Input cancelled. Exiting.\");\n} else {\n  const minutes = parseInt(breakMinutes, 10);\n  const [hourStr, minuteStr] = timeInput.split(\":\");\n  const hour = parseInt(hourStr, 10);\n  const minute = parseInt(minuteStr, 10);\n\n  if (\n    isNaN(minutes) || (minutes !== 15 && minutes !== 30) ||\n    isNaN(hour) || isNaN(minute) ||\n    hour < 0 || hour > 23 || minute < 0 || minute > 59\n  ) {\n    console.log(\"‚ùå Invalid input. Please enter 15 or 30 minutes and valid HH:MM time.\");\n  } else {\n    // Calculate delay until scheduled time\n    const now = new Date();\n    const target = new Date();\n    target.setHours(hour, minute, 0, 0);\n    let delay = target - now;\n\n    if (delay < 0) {\n      console.log(\"‚ùå The time has already passed today.\");\n    } else {\n      console.log(`‚è≥ Code scheduled at ${hour.toString().padStart(2,'0')}:${minute.toString().padStart(2,'0')} for a ${minutes}-minute break`);\n\n      setTimeout(() => {\n        console.log(`‚úÖ Running ${minutes}-minute break script...`);\n\n        const offlineBtn = document.querySelector('[aria-label=\"Offline\"], [title=\"Offline\"]');\n        if (!offlineBtn) return console.log('‚ùå Offline button not found');\n\n        // Click Offline first\n        offlineBtn.click();\n\n        setTimeout(() => {\n          let menuItemText = minutes === 30 ? 'Scheduled Lunch' : 'Scheduled Short Break';\n\n          // Click the correct scheduled menu item\n          const menuBtn = Array.from(document.querySelectorAll('[role=\"menuitem\"]'))\n            .find(el => el.innerText.includes(menuItemText));\n\n          if (!menuBtn) return console.log(`‚ùå ${menuItemText} not found`);\n          menuBtn.click();\n          console.log(`‚úÖ ${menuItemText} clicked`);\n\n          // Now the button label has changed; after break duration, switch back to \"Offline\" or \"French Data\"\n          setTimeout(() => {\n            const currentBtn = document.querySelector(`[aria-label=\"${menuItemText}\"], [title=\"${menuItemText}\"]`);\n            if (currentBtn) {\n              // Click it to open menu and switch back\n              currentBtn.click();\n              setTimeout(() => {\n                const offlineMenuBtn = Array.from(document.querySelectorAll('[role=\"menuitem\"]'))\n                  .find(el => el.innerText.includes('Offline') || el.innerText.includes('French Data'));\n                if (offlineMenuBtn) {\n                  offlineMenuBtn.click();\n                  console.log(`üîÑ ${menuItemText} ended, switched back to Offline/French Data`);\n                } else {\n                  console.log('‚ùå Could not find Offline/French Data button to switch back');\n                }\n              }, 300); // small delay to let menu appear\n            }\n          }, minutes * 60 * 1000); // convert break minutes to ms\n\n        }, 300); // delay for menu to appear after clicking Offline\n\n      }, delay);\n    }\n  }\n}\n"
    }
  ]
}